{
  "$schema": "https://json.schemastore.org/claude-hooks.json",
  "_comment": "임베디드 개발용 훅 설정",
  "hooks": {
    "PreToolUse": [
      {
        "_comment": "위험한 Bash 명령어 차단",
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"$CLAUDE_TOOL_INPUT\" | grep -qE '(rm -rf /|rm -rf ~|sudo rm|> /dev/|chmod 777|st-flash erase$)' && echo 'BLOCK: Dangerous command detected' && exit 1 || exit 0"
          }
        ]
      },
      {
        "_comment": "링커 설정(.icf) 수정 시 경고",
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"$CLAUDE_TOOL_INPUT\" | grep -qE '\\.icf' && echo 'WARNING: Modifying linker configuration file (.icf). Verify memory layout after change.' || exit 0"
          }
        ]
      },
      {
        "_comment": "ISR 파일 수정 시 경고",
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"$CLAUDE_TOOL_INPUT\" | grep -qE '(stm32f10x_it\\.|_IRQHandler|_Handler)' && echo 'WARNING: Modifying interrupt handler code. Verify ISR safety.' || exit 0"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "_comment": "C 파일 수정 후 volatile 누락 경고",
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -qE '\\.[ch]$'; then if [ -f \"$CLAUDE_FILE_PATH\" ]; then grep -n 'extern.*[^v].*flag\\|extern.*[^v].*count\\|extern.*[^v].*ready' \"$CLAUDE_FILE_PATH\" 2>/dev/null | grep -v volatile | head -3 | while read line; do echo \"HINT: Consider volatile for ISR-shared variable: $line\"; done; fi; fi; exit 0"
          }
        ]
      },
      {
        "_comment": "Git 커밋 후 상태 확인",
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$CLAUDE_TOOL_INPUT\" | grep -q 'git commit'; then git log --oneline -1 2>/dev/null; fi; exit 0"
          }
        ]
      }
    ],
    "Notification": [
      {
        "_comment": "작업 완료 알림 (Linux)",
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "# notify-send 'Claude Code (Embedded)' 'Task completed'"
          }
        ]
      }
    ],
    "Stop": [
      {
        "_comment": "세션 종료 시 임시 파일 정리",
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "# rm -f /tmp/claude-embedded-*.tmp 2>/dev/null; exit 0"
          }
        ]
      }
    ]
  }
}
